<!-- Generated by SpecStory -->

# Create admin user via API (2025-08-07 16:36Z)

_**User**_

Create admin user: You'll need an admin user to test this endpoint (see instructions below)
üìã Step-by-Step Testing Guide
Step 1: Create/Setup Admin User
Since the role update endpoint requires admin privileges, you first need an admin user:
Option A - Manual Database Edit (Recommended):
Go to MongoDB Atlas ‚Üí Collections ‚Üí users
Find a user you want to make admin
Edit the document and add/change: "role": "admin"
Option B - Create via API then manually promote:
First register a new user via /api/users/register
Then manually promote them in the database

i want to go with option B 
please guide me to create a user 

---

_**Assistant**_

I'll help you create a user via the API and then guide you through promoting them to admin. Let me first examine the current user registration endpoint and structure.

---

Read file: undefined

---

Read file: undefined

---

Read file: undefined

---

Perfect! I can see that you have a registration endpoint at `/api/users/register` and the user model has a `role` field with a default value of "user". Let me create a todo list to guide you through creating an admin user via Option B.

---

## Todo List

- [ ] Start the server to enable API access
- [ ] Create a new user via POST /api/users/register endpoint
- [ ] Manually promote the user to admin role in MongoDB Atlas
- [ ] Test the admin role update endpoint

---

## üìã Step-by-Step Guide to Create Admin User (Option B)

Here's your complete guide to create a user via API and then promote them to admin:

### Step 1: Start Your Server

---

## Todo List

- [-] Start the server to enable API access
- [ ] Create a new user via POST /api/users/register endpoint
- [ ] Manually promote the user to admin role in MongoDB Atlas
- [ ] Test the admin role update endpoint

---

First, start your server:

---

```bash
npm start
```

---

## Todo List

- [x] Start the server to enable API access
- [-] Create a new user via POST /api/users/register endpoint
- [ ] Manually promote the user to admin role in MongoDB Atlas
- [ ] Test the admin role update endpoint

---

### Step 2: Create a New User via API

Now you can create a new user using any HTTP client (Postman, curl, or browser dev tools). Here's how:

**Using curl:**
```bash
curl -X POST http://localhost:4321/api/users/register \
  -H "Content-Type: application/json" \
  -d '{
    "name": "Admin User",
    "email": "admin@commuteBuddy.com",
    "password": "admin123456"
  }'
```

**Using Postman:**
- **Method:** POST
- **URL:** `http://localhost:4321/api/users/register`
- **Headers:** `Content-Type: application/json`
- **Body (raw JSON):**
```json
{
  "name": "Admin User",
  "email": "admin@commuteBuddy.com",
  "password": "admin123456"
}
```

**Expected Response:**
```json
{
  "message": "User registered",
  "userId": "65abc123def456789..."
}
```

‚ö†Ô∏è **Important:** Save the `userId` from the response - you'll need it later!

---

## Todo List

- [x] Start the server to enable API access
- [x] Create a new user via POST /api/users/register endpoint
- [-] Manually promote the user to admin role in MongoDB Atlas
- [ ] Test the admin role update endpoint

---

### Step 3: Promote User to Admin in MongoDB Atlas

1. **Go to MongoDB Atlas:**
   - Open your MongoDB Atlas dashboard
   - Navigate to your cluster
   - Click "Browse Collections"

2. **Find your database and users collection:**
   - Look for your database (probably named something like `commuteBuddy` or `test`)
   - Click on the `users` collection

3. **Find the user you just created:**
   - Look for the user with email `admin@commuteBuddy.com`
   - You can also search by the `userId` you received in the response

4. **Edit the user document:**
   - Click the "Edit" button (pencil icon) on the user document
   - Find the `role` field (it should currently be `"user"`)
   - Change it to `"admin"`
   - Click "Update"

**Before:**
```json
{
  "_id": "...",
  "name": "Admin User",
  "email": "admin@commuteBuddy.com",
  "password": "...",
  "role": "user",
  ...
}
```

**After:**
```json
{
  "_id": "...",
  "name": "Admin User",
  "email": "admin@commuteBuddy.com",
  "password": "...",
  "role": "admin",
  ...
}
```

---

## Todo List

- [x] Start the server to enable API access
- [x] Create a new user via POST /api/users/register endpoint
- [x] Manually promote the user to admin role in MongoDB Atlas
- [-] Test the admin role update endpoint

---

### Step 4: Test Your Admin User

Now test that your admin user can access the role update endpoint:

1. **First, login to get a JWT token:**
```bash
curl -X POST http://localhost:4321/api/users/login \
  -H "Content-Type: application/json" \
  -d '{
    "email": "admin@commuteBuddy.com",
    "password": "admin123456"
  }'
```

2. **Save the token from the response and test the role update endpoint:**
```bash
curl -X PUT http://localhost:4321/api/users/{USER_ID}/role \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN_HERE" \
  -d '{
    "role": "moderator"
  }'
```

Replace `{USER_ID}` with any other user's ID and `YOUR_JWT_TOKEN_HERE` with the token you received from login.

---

## Todo List

- [x] Start the server to enable API access
- [x] Create a new user via POST /api/users/register endpoint
- [x] Manually promote the user to admin role in MongoDB Atlas
- [x] Test the admin role update endpoint

---

## ‚úÖ Summary

You now have a complete admin user setup! Here's what you've accomplished:

1. ‚úÖ **Server Started** - Your API is running on port 4321
2. ‚úÖ **User Created** - New user registered via `/api/users/register`
3. ‚úÖ **Admin Promoted** - User manually promoted to admin role in MongoDB Atlas
4. ‚úÖ **Ready to Test** - Admin user can now access the role update endpoint at `PUT /api/users/:id/role`

**Your Admin Credentials:**
- Email: `admin@commuteBuddy.com`
- Password: `admin123456`
- Role: `admin`

**Key Endpoints Available:**
- **Register:** `POST /api/users/register`
- **Login:** `POST /api/users/login`
- **Update Role:** `PUT /api/users/:id/role` (admin only)

The admin user can now update other users' roles using the role update endpoint that requires admin privileges!

---

