<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="home.css" />
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  </head>

  <body>
    <nav class="navi">
      <div class="logo">
        <div class="com">Commute</div>
        <div class="bud">Buddy</div>
      </div>
      <ul>
        <li class="h"><a href="#home">Home</a></li>
        <li class="about"><a href="#about">About</a></li>
        <li class="help"><a href="#help">Help</a></li>
        <li class="blog"><a href="#blog">Blog</a></li>

        <li class="Register">
          <button class="regi" onclick="window.location.href='register.html'">
            Register
          </button>
        </li>
      </ul>
    </nav>
    <section class="home">
      <div class="content">
        <h1>Welcome to our<br />community</h1>
        <h4 class="note">
          Start your new journey with us and join<br />our community for safe
          and reliable<br />
          traveling
        </h4>
        <button class="explore">Explore our community</button>
      </div>

      <form class="login">
        <input
          type="email"
          placeholder="Enter your email address"
          class="email"
          required
        />
        <input
          type="password"
          placeholder="Password"
          class="password"
          required
        />
        <div class="rememberPass">
          <input type="checkbox" class="remember" />
          <p class="rem">Remember me</p>
          <p class="forgotPass">Forget Password</p>
        </div>
        <button type="submit" class="sign">SIGN IN</button>
        <p class="connect">Or connect with</p>
        <div class="social">
          <button type="button" class="twitter">Twitter</button>
          <button type="button" class="facebook">Facebook</button>
        </div>
      </form>
    </section>

    <section class="about"></section>

    <section class="help"></section>

    <section class="blog"></section>

    <script>
      const loginForm = document.querySelector(".login");

      loginForm.addEventListener("submit", async (e) => {
        e.preventDefault();

        const email = loginForm.querySelector(".email").value;
        const password = loginForm.querySelector(".password").value;

        try {
          const response = await axios.post(
            "https://commute-buddy-fegt.onrender.com/api/users/login",
            { email, password }
          );
          alert(response.data.message); // "Login successful"

          // Store JWT token
          localStorage.setItem("token", response.data.token);

          // Store userId for dashboard usage
          localStorage.setItem("userId", response.data.userId);

          // Redirect to dashboard
          window.location.href = "profile.html";
        } catch (err) {
          if (err.response) {
            alert(err.response.data.error);
          } else {
            alert("Server error");
          }
        }
      });
    </script>
  </body>
</html>
